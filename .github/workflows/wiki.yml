name: Publish wiki

on: push

jobs:
  convert_via_pandoc:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v3
      - name: create output folder
        id: output_folder
        run: |
          mkdir output
      - uses: docker://pandoc/extra:3.0.1
        with:
          entrypoint: /bin/sh
          args: >-
            -c "
              for f in docs/*.md; do
                echo $f
                g=$(basename -- "$f" .md)
                echo $g
                pandoc --standalone --embed-resource \
                --css=https://gist.githubusercontent.com/dashed/6714393/raw/ae966d9d0806eb1e24462d88082a0264438adc50/github-pandoc.css \
                -f markdown+mark+emoji+wikilinks_title_after_pipe \
                -t html \
                --output=output/$g.html \
                $f
              done
            "
      - uses: actions/upload-artifact@v3
        with:
          name: output
          path: output
          
